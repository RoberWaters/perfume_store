{% extends 'base.html' %}

{% block title %}Carrito - Perfume Shop{% endblock %}

{% block content %}
<h1>Mi Carrito de Compras</h1>

{% if cart.items.all %}
<div style="margin: 2rem 0;">
    {% for item in cart.items.all %}
    <div class="cart-item">
        <div class="cart-item-info">
            <h3>{{ item.perfume.name }}</h3>
            <p>{{ item.perfume.brand.name }} - {{ item.perfume.volume_ml }}ml</p>
            <p style="font-size: 1.2rem; color: #2c5f2d; font-weight: bold;">L{{ item.perfume.price }} c/u</p>
        </div>
        <div class="cart-actions">
            <form method="post" action="{% url 'shop:update_cart' item.id %}" style="display: inline;">
                {% csrf_token %}
                <input type="hidden" name="action" value="decrease">
                <button type="submit" class="btn btn-secondary">-</button>
            </form>
            <span style="margin: 0 1rem; font-weight: bold;">{{ item.quantity }}</span>
            <form method="post" action="{% url 'shop:update_cart' item.id %}" style="display: inline;">
                {% csrf_token %}
                <input type="hidden" name="action" value="increase">
                <button type="submit" class="btn btn-secondary">+</button>
            </form>
            <span style="margin: 0 1rem; font-size: 1.2rem; font-weight: bold;">L{{ item.get_subtotal }}</span>
            <form method="post" action="{% url 'shop:update_cart' item.id %}" style="display: inline;">
                {% csrf_token %}
                <input type="hidden" name="action" value="remove">
                <button type="submit" class="btn btn-danger">Eliminar</button>
            </form>
        </div>
    </div>
    {% endfor %}
</div>

<div style="text-align: right; margin: 2rem 0; padding: 1rem; background: #f5f5f5; border-radius: 4px;">
    <h2>Total: L{{ cart.get_total }}</h2>
    <a href="{% url 'orders:checkout' %}" class="btn" style="font-size: 1.2rem; padding: 1rem 2rem; margin-top: 1rem;">Proceder al Pago</a>
</div>
{% else %}
<p>Tu carrito está vacío.</p>
<a href="{% url 'shop:perfume_list' %}" class="btn">Ir a Comprar</a>
{% endif %}
{% endblock %}
